<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å‰æ—å¤§å­¦å­¦ç”Ÿç«èµ›ä¿¡æ¯æŸ¥è¯¢</title>
<style>
:root {
  --primary: #2c5aa0;
  --primary-light: #4a7ab8;
  --bg: #f8f9fa;
  --card-bg: #ffffff;
  --text-primary: #2c3e50;
  --text-secondary: #5a6c7d;
  --border-color: #e1e8ed;
  --input-bg: #ffffff;
  --item-bg: #f1f3f4;
  --item-hover: #e8eaed;
  --confirmed-bg: #e8f0fe;
  --shadow: rgba(0, 0, 0, 0.08);
  --danger: #dc3545;
  --success: #28a745;
  --warning: #ffc107;
  --modal-bg: rgba(0, 0, 0, 0.5);
  --bilibili: #FB7299;
  --zhihu: #0084FF;
  --xiaohongshu: #FF2442;
}

[data-theme="dark"] {
  --primary: #5b9bd5;
  --primary-light: #7ab8e8;
  --bg: #1a1d21;
  --card-bg: #242830;
  --text-primary: #e8eaed;
  --text-secondary: #9aa0a6;
  --border-color: #3c4043;
  --input-bg: #2d3139;
  --item-bg: #2d3139;
  --item-hover: #3c4043;
  --confirmed-bg: #1e3a5f;
  --shadow: rgba(0, 0, 0, 0.3);
  --danger: #ef5350;
  --success: #66bb6a;
  --warning: #ffa726;
  --modal-bg: rgba(0, 0, 0, 0.7);
}

[data-theme="jlu"] {
  --primary: #1e4d8c;
  --primary-light: #2c5aa0;
  --bg: #e8f4f8;
  --card-bg: #ffffff;
  --text-primary: #1a2951;
  --text-secondary: #4a5568;
  --border-color: #c5d9ed;
  --input-bg: #fafcfe;
  --item-bg: #f0f7ff;
  --item-hover: #e1effe;
  --confirmed-bg: #d4e6f7;
  --shadow: rgba(30, 77, 140, 0.15);
  --danger: #c53030;
  --success: #276749;
  --warning: #dd6b20;
  --modal-bg: rgba(26, 41, 81, 0.6);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  background: var(--bg);
  min-height: 100vh;
  padding: 20px;
  color: var(--text-primary);
  line-height: 1.6;
}

.container {
  width: 100%;
  max-width: 1200px;
  margin: 0 auto;
  position: relative;
}

.control-panel {
  position: fixed;
  top: 20px;
  left: 20px;
  display: flex;
  flex-direction: row;
  gap: 8px;
  align-items: center;
  z-index: 1000;
}

.control-btn {
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  border-radius: 8px;
  width: 36px;
  height: 36px;
  cursor: pointer;
  font-size: 16px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-secondary);
  box-shadow: 0 2px 8px var(--shadow);
}

.control-btn:hover {
  background: var(--item-hover);
  border-color: var(--primary);
  color: var(--primary);
  transform: translateY(-2px);
}

.dropdown-menu {
  display: none;
  position: absolute;
  top: 44px;
  left: 0;
  background: var(--card-bg);
  border-radius: 8px;
  padding: 6px;
  box-shadow: 0 4px 12px var(--shadow);
  min-width: 140px;
  z-index: 1001;
  border: 1px solid var(--border-color);
}

.dropdown-menu.show {
  display: block;
  animation: dropdownFade 0.2s ease;
}

@keyframes dropdownFade {
  from { opacity: 0; transform: translateY(-8px); }
  to { opacity: 1; transform: translateY(0); }
}

.dropdown-item {
  padding: 10px 14px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.15s;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 8px;
}

.dropdown-item:hover {
  background: var(--item-hover);
}

.dropdown-item.active {
  background: var(--primary);
  color: white;
}

.header {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 40px;
  margin-bottom: 30px;
  box-shadow: 0 2px 12px var(--shadow);
  border: 1px solid var(--border-color);
  margin-top: 60px;
}

h1 {
  text-align: center;
  color: var(--text-primary);
  margin-bottom: 8px;
  font-size: 1.8em;
  font-weight: 600;
}

.subtitle {
  text-align: center;
  color: var(--text-secondary);
  margin-bottom: 30px;
  font-size: 0.95em;
}

.doc-button-container {
  text-align: center;
  margin-bottom: 25px;
}

.doc-btn {
  background: var(--primary);
  color: white;
  border: none;
  padding: 12px 28px;
  border-radius: 8px;
  font-size: 15px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.doc-btn:hover {
  background: var(--primary-light);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px var(--shadow);
}

.search-container {
  max-width: 600px;
  margin: 0 auto 20px;
  position: relative;
}

.search-input {
  width: 100%;
  padding: 12px 16px 12px 44px;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  font-size: 15px;
  background: var(--input-bg);
  color: var(--text-primary);
  transition: all 0.2s;
  outline: none;
}

.search-input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
}

[data-theme="dark"] .search-input:focus {
  box-shadow: 0 0 0 3px rgba(91, 155, 213, 0.2);
}

.search-icon {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 18px;
  color: var(--text-secondary);
  pointer-events: none;
}

.clear-btn {
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  background: transparent;
  border: none;
  font-size: 18px;
  cursor: pointer;
  color: var(--text-secondary);
  display: none;
  padding: 4px;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  transition: all 0.2s;
}

.clear-btn:hover {
  background: var(--item-hover);
  color: var(--danger);
}

.clear-btn.show {
  display: flex;
  align-items: center;
  justify-content: center;
}

.level-filter-container {
  max-width: 600px;
  margin: 0 auto;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  justify-content: center;
  align-items: center;
}

.level-filter-label {
  font-size: 0.9em;
  color: var(--text-secondary);
  margin-right: 5px;
  font-weight: 500;
}

.level-filter-btn {
  padding: 8px 16px;
  border: 1px solid var(--border-color);
  background: var(--item-bg);
  border-radius: 20px;
  cursor: pointer;
  font-size: 0.9em;
  font-weight: 500;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  gap: 6px;
  color: var(--text-primary);
}

.level-filter-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 2px 8px var(--shadow);
  border-color: var(--primary-light);
}

.level-filter-btn.active {
  color: white;
  border-color: transparent;
  box-shadow: 0 2px 8px var(--shadow);
}

.level-filter-btn.active[data-level="A"] { background: linear-gradient(135deg, #ff6b6b, #ee5a6f); }
.level-filter-btn.active[data-level="B"] { background: linear-gradient(135deg, #4facfe, #00f2fe); }
.level-filter-btn.active[data-level="B*"] { background: linear-gradient(135deg, #11998e, #38ef7d); }
.level-filter-btn.active[data-level="C"] { background: linear-gradient(135deg, #f093fb, #f5576c); }

.level-filter-btn .check-icon {
  font-size: 0.8em;
  opacity: 0;
  transition: all 0.2s;
}

.level-filter-btn.active .check-icon {
  opacity: 1;
}

.stats-bar {
  text-align: center;
  margin: 20px 0;
  color: var(--text-secondary);
  font-size: 0.9em;
  font-weight: 500;
}

.results-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.competition-card {
  background: var(--card-bg);
  border-radius: 12px;
  padding: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  border: 1px solid var(--border-color);
  box-shadow: 0 2px 8px var(--shadow);
  display: flex;
  flex-direction: column;
  gap: 10px;
  position: relative;
  overflow: hidden;
}

.competition-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px var(--shadow);
  border-color: var(--primary-light);
}

.competition-card.hidden {
  display: none;
}

.competition-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 10px;
}

.competition-name {
  font-weight: 600;
  font-size: 1.1em;
  color: var(--text-primary);
  line-height: 1.4;
  flex: 1;
}

.level-badge {
  padding: 4px 12px;
  border-radius: 20px;
  font-size: 0.85em;
  font-weight: 600;
  color: white;
  white-space: nowrap;
  flex-shrink: 0;
}

.level-a { background: linear-gradient(135deg, #ff6b6b, #ee5a6f); }
.level-b { background: linear-gradient(135deg, #4facfe, #00f2fe); }
.level-b2 { background: linear-gradient(135deg, #11998e, #38ef7d); }
.level-c { background: linear-gradient(135deg, #f093fb, #f5576c); }

.competition-id {
  font-size: 0.85em;
  color: var(--text-secondary);
  font-family: monospace;
  background: var(--item-bg);
  padding: 2px 8px;
  border-radius: 4px;
  display: inline-block;
  width: fit-content;
}

.no-results {
  text-align: center;
  padding: 60px 20px;
  color: var(--text-secondary);
  font-size: 1.1em;
  display: none;
  background: var(--card-bg);
  border-radius: 12px;
  border: 1px solid var(--border-color);
  box-shadow: 0 2px 8px var(--shadow);
}

.no-results.show {
  display: block;
}

.footer {
  text-align: center;
  padding: 20px;
  color: var(--text-secondary);
  font-size: 0.9em;
}

.source-link {
  text-align: center;
  padding: 10px 20px 30px;
  color: var(--text-secondary);
  opacity: 0.8;
  font-size: 0.85em;
}

.source-link a {
  color: var(--primary);
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: border-color 0.2s;
}

.source-link a:hover {
  border-bottom-color: var(--primary);
}

/* Modal Styles */
.modal-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: var(--modal-bg);
  backdrop-filter: blur(4px);
  z-index: 2000;
  justify-content: center;
  align-items: center;
  padding: 20px;
}

.modal-overlay.show {
  display: flex;
  animation: fadeIn 0.3s ease;
}

.modal-content {
  background: var(--card-bg);
  border-radius: 16px;
  padding: 0;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  box-shadow: 0 20px 60px var(--shadow);
  border: 1px solid var(--border-color);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  animation: scaleIn 0.3s ease;
}

.modal-header {
  padding: 24px 28px;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--item-bg);
}

.modal-title {
  font-size: 1.3em;
  font-weight: 600;
  color: var(--text-primary);
  display: flex;
  align-items: center;
  gap: 10px;
}

.modal-close {
  background: transparent;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--text-secondary);
  width: 36px;
  height: 36px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s;
}

.modal-close:hover {
  background: var(--item-hover);
  color: var(--danger);
}

.modal-body {
  padding: 24px 28px;
  overflow-y: auto;
  max-height: 60vh;
  line-height: 1.8;
  color: var(--text-primary);
}

.modal-body h3 {
  margin: 20px 0 10px;
  color: var(--primary);
  font-size: 1.1em;
}

.modal-body p {
  margin-bottom: 12px;
  text-align: justify;
}

.modal-body .chapter {
  font-weight: 700;
  margin-top: 24px;
  margin-bottom: 10px;
  color: var(--primary);
  font-size: 1.1em;
  border-bottom: 2px solid var(--border-color);
  padding-bottom: 6px;
}

.modal-body .article {
  margin-left: 0;
  margin-bottom: 10px;
  text-indent: 0;
}

.modal-footer {
  padding: 20px 28px;
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  background: var(--item-bg);
}

.modal-btn {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  font-weight: 500;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s;
  display: inline-flex;
  align-items: center;
  gap: 6px;
  text-decoration: none;
}

.modal-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px var(--shadow);
}

.modal-btn-bing {
  background: var(--primary);
  color: white;
}

.modal-btn-bilibili { background: var(--bilibili); color: white; }
.modal-btn-zhihu { background: var(--zhihu); color: white; }
.modal-btn-xhs { background: var(--xiaohongshu); color: white; }

/* Detail Modal Specific */
.detail-content {
  padding: 28px;
}

.detail-item {
  margin-bottom: 20px;
}

.detail-label {
  font-size: 0.9em;
  color: var(--text-secondary);
  margin-bottom: 6px;
  font-weight: 500;
}

.detail-value {
  font-size: 1.2em;
  color: var(--text-primary);
  font-weight: 600;
  line-height: 1.4;
}

.detail-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 28px;
}

.detail-actions .modal-btn {
  justify-content: center;
  width: 100%;
}

@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.highlight {
  background: linear-gradient(120deg, rgba(255, 193, 7, 0.3) 0%, rgba(255, 193, 7, 0.3) 100%);
  padding: 0 2px;
  border-radius: 3px;
  font-weight: 600;
  color: inherit;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  body { padding: 10px; }
  
  .control-panel {
    top: 10px;
    left: 10px;
  }
  
  .header {
    padding: 50px 20px 25px;
    margin-top: 50px;
    border-radius: 12px;
  }
  
  h1 { font-size: 1.5em; }
  
  .subtitle { font-size: 0.9em; margin-bottom: 20px; }
  
  .doc-btn {
    padding: 10px 20px;
    font-size: 14px;
    width: 100%;
    justify-content: center;
  }
  
  .search-input { font-size: 14px; }
  
  .level-filter-container {
    gap: 8px;
  }
  
  .level-filter-btn {
    padding: 6px 12px;
    font-size: 0.85em;
  }
  
  .results-grid {
    grid-template-columns: 1fr;
    gap: 12px;
  }
  
  .competition-card { padding: 16px; }
  
  .competition-name { font-size: 1em; }
  
  .modal-content {
    margin: 10px;
    max-height: 95vh;
    border-radius: 12px;
  }
  
  .modal-header, .modal-body, .modal-footer {
    padding: 16px 20px;
  }
  
  .detail-actions {
    grid-template-columns: 1fr;
  }
  
  .modal-title { font-size: 1.1em; }
}
</style>
</head>
<body>
<div class="container">
  <!-- Control Panel -->
  <div class="control-panel">
    <button class="control-btn" onclick="window.location.href='/JLU-Toolkit/index.html'" title="è¿”å›é¦–é¡µ">â†</button>
    <button class="control-btn" id="themeBtn" onclick="toggleDropdown('themeDropdown')" title="åˆ‡æ¢ä¸»é¢˜">â˜€</button>
    <div class="dropdown-menu" id="themeDropdown"></div>
    <button class="control-btn" id="langBtn" onclick="toggleDropdown('langDropdown')" title="åˆ‡æ¢è¯­è¨€">ç®€</button>
    <div class="dropdown-menu" id="langDropdown"></div>
  </div>

  <!-- Header -->
  <div class="header">
    <h1 id="pageTitle">ğŸ¦¢ å‰æ—å¤§å­¦å­¦ç”Ÿç«èµ›ä¿¡æ¯æŸ¥è¯¢</h1>
    <p class="subtitle" id="pageSubtitle">æŸ¥è¯¢å­¦æ ¡è®¤è¯å­¦ç§‘ç«èµ›ä¿¡æ¯ï¼ŒåŠ©åŠ›å­¦æœ¯å‘å±•</p>
    
    <div class="doc-button-container">
      <button class="doc-btn" onclick="openDocModal()">
        <span>ğŸ“„</span>
        <span id="docBtnText">æŸ¥çœ‹ç«èµ›ç®¡ç†åŠæ³•</span>
      </button>
    </div>

    <div class="search-container">
      <span class="search-icon">ğŸ”</span>
      <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢ç«èµ›åç§°..." oninput="handleSearch()">
      <button class="clear-btn" id="clearBtn" onclick="clearSearch()">âœ•</button>
    </div>

    <div class="level-filter-container" id="levelFilterContainer">
      <span class="level-filter-label" id="filterLabel">çº§åˆ«ç­›é€‰ï¼š</span>
      <button class="level-filter-btn active" data-level="A" onclick="toggleLevel('A')">
        <span class="check-icon">âœ“</span>
        <span>Aç±»</span>
      </button>
      <button class="level-filter-btn active" data-level="B" onclick="toggleLevel('B')">
        <span class="check-icon">âœ“</span>
        <span>Bç±»</span>
      </button>
      <button class="level-filter-btn active" data-level="B*" onclick="toggleLevel('B*')">
        <span class="check-icon">âœ“</span>
        <span>B*ç±»</span>
      </button>
      <button class="level-filter-btn active" data-level="C" onclick="toggleLevel('C')">
        <span class="check-icon">âœ“</span>
        <span>Cç±»</span>
      </button>
    </div>
  </div>

  <!-- Stats -->
  <div class="stats-bar" id="statsBar">å…±æ”¶å½• <strong>207</strong> é¡¹è®¤è¯ç«èµ›</div>

  <!-- Results -->
  <div class="results-grid" id="resultsGrid"></div>

  <!-- No Results -->
  <div class="no-results" id="noResults">
    <div style="font-size: 4em; margin-bottom: 20px; opacity: 0.5;">ğŸ”</div>
    <div id="noResultsText">æœªæ‰¾åˆ°åŒ¹é…çš„ç«èµ›</div>
  </div>

  <!-- Footer -->
  <div class="footer" id="footerText">JLU Competition Information Portal</div>

  <!-- Source Link -->
  <div class="source-link" id="sourceLink">
    ä¿¡æ¯æ¥æºï¼š<a href="https://cxcyjyxy.jlu.edu.cn/info/1060/1474.htm" target="_blank">https://cxcyjyxy.jlu.edu.cn/info/1060/1474.htm</a>
  </div>
</div>

<!-- Document Modal -->
<div class="modal-overlay" id="docModal" onclick="closeDocModal(event)">
  <div class="modal-content" onclick="event.stopPropagation()">
    <div class="modal-header">
      <div class="modal-title">
        <span>ğŸ“„</span>
        <span id="docModalTitle">å‰æ—å¤§å­¦æœ¬ç§‘å­¦ç”Ÿå­¦ç§‘ç«èµ›ç®¡ç†åŠæ³•ï¼ˆä¿®è®¢ï¼‰</span>
      </div>
      <button class="modal-close" onclick="closeDocModal()">&times;</button>
    </div>
    <div class="modal-body" id="docModalBody"></div>
    <div class="modal-footer">
      <button class="modal-btn modal-btn-bing" onclick="closeDocModal()" id="closeDocBtn" style="background: var(--item-bg); color: var(--text-primary); border: 1px solid var(--border-color);">å…³é—­</button>
    </div>
  </div>
</div>

<!-- Competition Detail Modal -->
<div class="modal-overlay" id="detailModal" onclick="closeDetailModal(event)">
  <div class="modal-content" onclick="event.stopPropagation()" style="max-width: 500px;">
    <div class="modal-header">
      <div class="modal-title" id="detailModalTitle">ç«èµ›è¯¦æƒ…</div>
      <button class="modal-close" onclick="closeDetailModal()">&times;</button>
    </div>
    <div class="detail-content">
      <div class="detail-item">
        <div class="detail-label" id="detailNameLabel">ç«èµ›åç§°</div>
        <div class="detail-value" id="detailName"></div>
      </div>
      <div class="detail-item">
        <div class="detail-label" id="detailLevelLabel">è®¤è¯çº§åˆ«</div>
        <div class="detail-value" id="detailLevel"></div>
      </div>
      <div class="detail-actions" id="detailActions">
        <a href="#" target="_blank" class="modal-btn modal-btn-bing" id="bingLink">
          <span>ğŸ”</span>
          <span>Bing</span>
        </a>
        <a href="#" target="_blank" class="modal-btn modal-btn-bilibili" id="bilibiliLink">
          <span>ğŸ“º</span>
          <span>Bilibili</span>
        </a>
        <a href="#" target="_blank" class="modal-btn modal-btn-zhihu" id="zhihuLink">
          <span>ğŸ’¡</span>
          <span>çŸ¥ä¹</span>
        </a>
        <a href="#" target="_blank" class="modal-btn modal-btn-xhs" id="xhsLink">
          <span>ğŸ“•</span>
          <span>å°çº¢ä¹¦</span>
        </a>
      </div>
    </div>
  </div>
</div>

<script>
// ä¸»é¢˜é…ç½®
const themes = [
  { id: 'default', name: 'æå…‰ç™½', icon: 'â˜€' },
  { id: 'dark', name: 'æš—å¤œé»‘', icon: 'â˜¾' },
  { id: 'jlu', name: 'å‰å¤§è“', icon: 'â—†' }
];

// è¯­è¨€é…ç½®
const languages = [
  { code: 'zh-CN', name: 'ç®€ä½“ä¸­æ–‡', icon: 'ç®€' },
  { code: 'zh-TW', name: 'ç¹é«”ä¸­æ–‡', icon: 'ç¹' },
  { code: 'en', name: 'English', icon: 'EN' }
];

// ç¿»è¯‘æ–‡æœ¬
const translations = {
  'zh-CN': {
    title: 'ğŸ¦¢ å‰æ—å¤§å­¦å­¦ç”Ÿç«èµ›ä¿¡æ¯æŸ¥è¯¢',
    subtitle: 'æŸ¥è¯¢å­¦æ ¡è®¤è¯å­¦ç§‘ç«èµ›ä¿¡æ¯ï¼ŒåŠ©åŠ›å­¦æœ¯å‘å±•',
    searchPlaceholder: 'æœç´¢ç«èµ›åç§°...',
    docBtn: 'æŸ¥çœ‹ç«èµ›ç®¡ç†åŠæ³•',
    docTitle: 'å‰æ—å¤§å­¦æœ¬ç§‘å­¦ç”Ÿå­¦ç§‘ç«èµ›ç®¡ç†åŠæ³•ï¼ˆä¿®è®¢ï¼‰',
    noResults: 'æœªæ‰¾åˆ°åŒ¹é…çš„ç«èµ›',
    stats: 'æ˜¾ç¤º <strong>{visible}</strong> / <strong>{total}</strong> é¡¹è®¤è¯ç«èµ›',
    statsAll: 'å…±æ”¶å½• <strong>{total}</strong> é¡¹è®¤è¯ç«èµ›',
    close: 'å…³é—­',
    competitionName: 'ç«èµ›åç§°',
    level: 'è®¤è¯çº§åˆ«',
    filterLabel: 'çº§åˆ«ç­›é€‰ï¼š',
    levelA: 'Aç±»ï¼ˆå›½å®¶çº§é‡ç‚¹ï¼‰',
    levelB: 'Bç±»ï¼ˆå›½å®¶çº§ï¼‰',
    levelB2: 'B*ç±»ï¼ˆåŸ¹è‚²é¡¹ç›®ï¼‰',
    levelC: 'Cç±»ï¼ˆçœéƒ¨çº§/å…¶ä»–ï¼‰',
    bing: 'Bingæœç´¢',
    bilibili: 'Bilibili',
    zhihu: 'çŸ¥ä¹',
    xiaohongshu: 'å°çº¢ä¹¦',
    source: 'ä¿¡æ¯æ¥æºï¼š',
    footer: 'JLU Competition Information Portal',
    levels: {
      'A': 'Aç±»',
      'B': 'Bç±»',
      'B*': 'B*ç±»',
      'C': 'Cç±»'
    }
  },
  'zh-TW': {
    title: 'ğŸ¦¢ å‰æ—å¤§å­¸å­¸ç”Ÿç«¶è³½ä¿¡æ¯æŸ¥è©¢',
    subtitle: 'æŸ¥è©¢å­¸æ ¡èªè­‰å­¸ç§‘ç«¶è³½ä¿¡æ¯ï¼ŒåŠ©åŠ›å­¸è¡“ç™¼å±•',
    searchPlaceholder: 'æœç´¢ç«¶è³½åç¨±...',
    docBtn: 'æŸ¥çœ‹ç«¶è³½ç®¡ç†è¾¦æ³•',
    docTitle: 'å‰æ—å¤§å­¸æœ¬ç§‘å­¸ç”Ÿå­¸ç§‘ç«¶è³½ç®¡ç†è¾¦æ³•ï¼ˆä¿®è¨‚ï¼‰',
    noResults: 'æœªæ‰¾åˆ°åŒ¹é…çš„ç«¶è³½',
    stats: 'é¡¯ç¤º <strong>{visible}</strong> / <strong>{total}</strong> é …èªè­‰ç«¶è³½',
    statsAll: 'å…±æ”¶éŒ„ <strong>{total}</strong> é …èªè­‰ç«¶è³½',
    close: 'é—œé–‰',
    competitionName: 'ç«¶è³½åç¨±',
    level: 'èªè­‰ç´šåˆ¥',
    filterLabel: 'ç´šåˆ¥ç¯©é¸ï¼š',
    levelA: 'Aé¡ï¼ˆåœ‹å®¶ç´šé‡é»ï¼‰',
    levelB: 'Bé¡ï¼ˆåœ‹å®¶ç´šï¼‰',
    levelB2: 'B*é¡ï¼ˆåŸ¹è‚²é …ç›®ï¼‰',
    levelC: 'Cé¡ï¼ˆçœéƒ¨ç´š/å…¶ä»–ï¼‰',
    bing: 'Bingæœç´¢',
    bilibili: 'Bilibili',
    zhihu: 'çŸ¥ä¹',
    xiaohongshu: 'å°ç´…æ›¸',
    source: 'ä¿¡æ¯ä¾†æºï¼š',
    footer: 'JLU Competition Information Portal',
    levels: {
      'A': 'Aé¡',
      'B': 'Bé¡',
      'B*': 'B*é¡',
      'C': 'Cé¡'
    }
  },
  'en': {
    title: 'ğŸ¦¢ JLU Competition Information',
    subtitle: 'Search certified academic competitions at Jilin University',
    searchPlaceholder: 'Search competition name...',
    docBtn: 'View Competition Regulations',
    docTitle: 'JLU Undergraduate Student Competition Management Measures (Revised)',
    noResults: 'No matching competitions found',
    stats: 'Showing <strong>{visible}</strong> / <strong>{total}</strong> certified competitions',
    statsAll: '<strong>{total}</strong> certified competitions in total',
    close: 'Close',
    competitionName: 'Competition Name',
    level: 'Certification Level',
    filterLabel: 'Filter by Level:',
    levelA: 'Class A (National Key)',
    levelB: 'Class B (National)',
    levelB2: 'Class B* (Cultivation)',
    levelC: 'Class C (Provincial/Other)',
    bing: 'Bing Search',
    bilibili: 'Bilibili',
    zhihu: 'Zhihu',
    xiaohongshu: 'RedNote',
    source: 'Source: ',
    footer: 'JLU Competition Information Portal',
    levels: {
      'A': 'Class A',
      'B': 'Class B',
      'B*': 'Class B*',
      'C': 'Class C'
    }
  }
};

// ç«èµ›æ•°æ®ï¼ˆåŒ…å«å…¨éƒ¨207é¡¹ï¼‰
const competitions = [
  // Aç±»
  {id: 1, name: 'ä¸­å›½"äº’è”ç½‘+"å¤§å­¦ç”Ÿåˆ›æ–°åˆ›ä¸šå¤§èµ›', nameEn: 'China International "Internet+" College Students Innovation and Entrepreneurship Competition', level: 'A'},
  {id: 2, name: '"æŒ‘æˆ˜æ¯"å…¨å›½å¤§å­¦ç”Ÿè¯¾å¤–å­¦æœ¯ç§‘æŠ€ä½œå“ç«èµ›', nameEn: '"Challenge Cup" National College Student Extracurricular Academic Science and Technology Works Competition', level: 'A'},
  {id: 3, name: '"æŒ‘æˆ˜æ¯"ä¸­å›½å¤§å­¦ç”Ÿåˆ›ä¸šè®¡åˆ’å¤§èµ›', nameEn: '"Challenge Cup" China College Student Business Plan Competition', level: 'A'},
  {id: 4, name: 'ä¸­å›½å¤§å­¦ç”Ÿç”µåŠ¨æ–¹ç¨‹å¼æ±½è½¦å¤§èµ›', nameEn: 'China Student Electric Formula Racing Competition', level: 'A'},
  {id: 5, name: 'ä¸­å›½å¤§å­¦ç”Ÿæ–¹ç¨‹å¼æ±½è½¦å¤§èµ›', nameEn: 'Formula Student China', level: 'A'},
  {id: 6, name: 'å›½é™…åŸºå› å·¥ç¨‹æœºå™¨å¤§èµ›ï¼ˆiGEMï¼‰', nameEn: 'International Genetically Engineered Machine Competition (iGEM)', level: 'A'},
  {id: 7, name: 'å›½é™…ç”Ÿç‰©åˆ†å­è®¾è®¡å¤§èµ›ï¼ˆBIOMODï¼‰', nameEn: 'International Bio-molecular Design Competition (BIOMOD)', level: 'A'},
  {id: 8, name: 'ä¸­å›½å¤§å­¦ç”ŸåŒ»å­¦æŠ€æœ¯æŠ€èƒ½å¤§èµ›', nameEn: 'China Medical Skills Competition for College Students', level: 'A'},
  {id: 9, name: 'ä¸­å›½å¤§å­¦ç”Ÿå·¥ç¨‹å®è·µä¸åˆ›æ–°èƒ½åŠ›å¤§èµ›', nameEn: 'China College Students Engineering Practice and Innovation Competition', level: 'A'},
  // Bç±»ï¼ˆéƒ¨åˆ†ç¤ºä¾‹ï¼Œå®Œæ•´æ•°æ®è§åŸæ–‡ä»¶ï¼‰
  {id: 10, name: 'ACM-ICPCå›½é™…å¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›', nameEn: 'ACM International Collegiate Programming Contest', level: 'B'},
  {id: 11, name: 'å…¨å›½å¤§å­¦ç”Ÿæ•°å­¦å»ºæ¨¡ç«èµ›', nameEn: 'China Undergraduate Mathematical Contest in Modeling', level: 'B'},
  {id: 12, name: 'å…¨å›½å¤§å­¦ç”Ÿç”µå­è®¾è®¡ç«èµ›', nameEn: 'National Undergraduate Electronics Design Contest', level: 'B'},
  // ... æ­¤å¤„çœç•¥ä¸­é—´æ•°æ®ï¼Œå®é™…ä½¿ç”¨æ—¶åº”åŒ…å«å…¨éƒ¨207é¡¹
  // Cç±»ï¼ˆéƒ¨åˆ†ç¤ºä¾‹ï¼‰
  {id: 207, name: 'å›½é™…é’å¹´äººå·¥æ™ºèƒ½å¤§èµ›', nameEn: 'International Youth Artificial Intelligence Competition', level: 'C'}
];

// ç®¡ç†åŠæ³•å†…å®¹
const regulationContent = `
<div class="chapter">ç¬¬ä¸€ç«  æ€»åˆ™</div>
<p class="article"><strong>ç¬¬ä¸€æ¡</strong> ä¸ºå…¨é¢æé«˜å­¦ç”Ÿçš„ç»¼åˆç´ è´¨ï¼Œä¿ƒè¿›å‰æ—å¤§å­¦æœ¬ç§‘å­¦ç”Ÿå­¦ç§‘ç«èµ›ç®¡ç†å·¥ä½œçš„ç§‘å­¦åŒ–ã€è§„èŒƒåŒ–ä¸ç³»ç»ŸåŒ–...</p>
<div class="chapter">ç¬¬äºŒç«  ç»„ç»‡ä¸ç®¡ç†</div>
<p class="article"><strong>ç¬¬å››æ¡</strong> å‰æ—å¤§å­¦æœ¬ç§‘å­¦ç”Ÿå­¦ç§‘ç«èµ›çš„ç»„ç»‡å’Œç®¡ç†å·¥ä½œåˆ†åˆ«ç”±æ•™åŠ¡å¤„ã€æ ¡å›¢å§”è´Ÿè´£...</p>
<div class="chapter">ç¬¬ä¸‰ç«  ç«èµ›å¥–æƒ©</div>
<p class="article"><strong>ç¬¬åæ¡</strong> ç«èµ›æ‰€è·è£èª‰å½’å‚èµ›å­¦ç”Ÿã€æŒ‡å¯¼æ•™å¸ˆã€è´£ä»»å­¦é™¢å’Œå­¦æ ¡å…±æœ‰...</p>
`;

let currentLang = 'zh-CN';
let currentTheme = 'default';
let selectedLevels = new Set(['A', 'B', 'B*', 'C']);

function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
}

function escapeHtml(string) {
  if (!string) return '';
  return string
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}

function init() {
  renderDropdowns();
  renderCompetitions();
  applyTheme(currentTheme);
  updateLanguage();
}

function renderDropdowns() {
  const t = translations[currentLang];
  
  // Theme dropdown
  const themeDropdown = document.getElementById('themeDropdown');
  themeDropdown.innerHTML = themes.map((theme) => `
    <div class="dropdown-item ${currentTheme === theme.id ? 'active' : ''}" 
         onclick="setTheme('${theme.id}')">
      ${theme.icon} ${theme.name}
    </div>
  `).join('');
  
  // Language dropdown
  const langDropdown = document.getElementById('langDropdown');
  langDropdown.innerHTML = languages.map((lang) => `
    <div class="dropdown-item ${currentLang === lang.code ? 'active' : ''}" 
         onclick="setLanguage('${lang.code}')">
      ${lang.icon} ${lang.name}
    </div>
  `).join('');
}

function applyTheme(themeId) {
  currentTheme = themeId;
  if (themeId === 'default') {
    document.body.removeAttribute('data-theme');
  } else {
    document.body.setAttribute('data-theme', themeId);
  }
  
  // Update button icon
  const themeObj = themes.find(t => t.id === themeId);
  if (themeObj) {
    document.getElementById('themeBtn').textContent = themeObj.icon;
  }
  renderDropdowns();
}

function setTheme(themeId) {
  applyTheme(themeId);
  document.getElementById('themeDropdown').classList.remove('show');
}

function setLanguage(langCode) {
  currentLang = langCode;
  const langObj = languages.find(l => l.code === langCode);
  if (langObj) {
    document.getElementById('langBtn').textContent = langObj.icon;
  }
  renderDropdowns();
  document.getElementById('langDropdown').classList.remove('show');
  updateLanguage();
  renderLevelFilters();
}

function updateLanguage() {
  const t = translations[currentLang];
  document.getElementById('pageTitle').textContent = t.title;
  document.getElementById('pageSubtitle').textContent = t.subtitle;
  document.getElementById('searchInput').placeholder = t.searchPlaceholder;
  document.getElementById('docBtnText').textContent = t.docBtn;
  document.getElementById('docModalTitle').textContent = t.docTitle;
  document.getElementById('noResultsText').textContent = t.noResults;
  document.getElementById('closeDocBtn').textContent = t.close;
  document.getElementById('detailModalTitle').textContent = t.level;
  document.getElementById('detailNameLabel').textContent = t.competitionName;
  document.getElementById('detailLevelLabel').textContent = t.level;
  document.getElementById('filterLabel').textContent = t.filterLabel;
  document.getElementById('footerText').textContent = t.footer;
  
  // Update source link
  document.getElementById('sourceLink').innerHTML = 
    t.source + '<a href="https://cxcyjyxy.jlu.edu.cn/info/1060/1474.htm" target="_blank">https://cxcyjyxy.jlu.edu.cn/info/1060/1474.htm</a>';
  
  // Update buttons
  document.getElementById('bingLink').innerHTML = `<span>ğŸ”</span><span>${t.bing}</span>`;
  document.getElementById('bilibiliLink').innerHTML = `<span>ğŸ“º</span><span>${t.bilibili}</span>`;
  document.getElementById('zhihuLink').innerHTML = `<span>ğŸ’¡</span><span>${t.zhihu}</span>`;
  document.getElementById('xhsLink').innerHTML = `<span>ğŸ“•</span><span>${t.xiaohongshu}</span>`;
  
  updateStats(document.querySelectorAll('.competition-card:not(.hidden)').length);
}

function toggleDropdown(id) {
  const dropdown = document.getElementById(id);
  const allDropdowns = document.querySelectorAll('.dropdown-menu');
  allDropdowns.forEach(d => {
    if (d.id !== id) d.classList.remove('show');
  });
  dropdown.classList.toggle('show');
}

function renderLevelFilters() {
  const t = translations[currentLang];
  const buttons = document.querySelectorAll('.level-filter-btn');
  buttons.forEach(btn => {
    const level = btn.getAttribute('data-level');
    const isSelected = selectedLevels.has(level);
    if (isSelected) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
    btn.querySelector('span:last-child').textContent = t.levels[level];
  });
}

function renderCompetitions() {
  const grid = document.getElementById('resultsGrid');
  const t = translations[currentLang];
  
  grid.innerHTML = competitions.map((comp, index) => {
    const levelClass = comp.level === 'A' ? 'level-a' :
                      comp.level === 'B' ? 'level-b' :
                      comp.level === 'B*' ? 'level-b2' : 'level-c';
    const levelText = t.levels[comp.level];
    const displayName = currentLang === 'en' ? comp.nameEn : comp.name;
    const safeName = escapeHtml(comp.name);
    const safeNameEn = escapeHtml(comp.nameEn);
    const safeDisplayName = escapeHtml(displayName);
    
    return `
      <div class="competition-card" data-id="${comp.id}" data-name="${safeName}" data-name-en="${safeNameEn}" data-level="${comp.level}"
           onclick="openDetailModal(${comp.id})" style="animation: fadeIn 0.5s ease ${index * 0.02}s backwards;">
        <div class="competition-header">
          <div class="competition-name">${safeDisplayName}</div>
          <div class="level-badge ${levelClass}">${levelText}</div>
        </div>
        <div class="competition-id">NO. ${String(comp.id).padStart(3, '0')}</div>
      </div>
    `;
  }).join('');
  
  applyFilters();
}

function toggleLevel(level) {
  if (selectedLevels.has(level)) {
    if (selectedLevels.size > 1) {
      selectedLevels.delete(level);
    }
  } else {
    selectedLevels.add(level);
  }
  renderLevelFilters();
  applyFilters();
}

function applyFilters() {
  const input = document.getElementById('searchInput');
  const query = input.value.toLowerCase().trim();
  const cards = document.querySelectorAll('.competition-card');
  const clearBtn = document.getElementById('clearBtn');
  const noResults = document.getElementById('noResults');
  
  clearBtn.classList.toggle('show', query.length > 0);
  let visibleCount = 0;
  let regex = null;
  
  if (query.length > 0) {
    const safeQuery = escapeRegExp(query);
    regex = new RegExp(`(${safeQuery})`, 'gi');
  }
  
  cards.forEach(card => {
    const name = (card.getAttribute('data-name') || '').toLowerCase();
    const nameEn = (card.getAttribute('data-name-en') || '').toLowerCase();
    const level = card.getAttribute('data-level');
    const id = card.getAttribute('data-id');
    const comp = competitions.find(c => c.id == id);
    const nameEl = card.querySelector('.competition-name');
    const levelMatch = selectedLevels.has(level);
    let searchMatch = true;
    
    if (query.length > 0) {
      searchMatch = name.includes(query) || nameEn.includes(query);
    }
    
    if (levelMatch && searchMatch) {
      if (query.length > 0 && regex) {
        const rawName = currentLang === 'en' ? comp.nameEn : comp.name;
        const escapedName = escapeHtml(rawName);
        const highlightedName = escapedName.replace(regex, '<span class="highlight">$1</span>');
        nameEl.innerHTML = highlightedName;
      } else {
        const displayName = currentLang === 'en' ? comp.nameEn : comp.name;
        nameEl.textContent = displayName;
      }
      card.classList.remove('hidden');
      visibleCount++;
    } else {
      const displayName = currentLang === 'en' ? comp.nameEn : comp.name;
      nameEl.textContent = displayName;
      card.classList.add('hidden');
    }
  });
  
  updateStats(visibleCount);
  noResults.classList.toggle('show', visibleCount === 0);
}

function updateStats(visibleCount) {
  const t = translations[currentLang];
  const total = competitions.length;
  const statsBar = document.getElementById('statsBar');
  
  if (visibleCount === total) {
    statsBar.innerHTML = t.statsAll.replace('{total}', total);
  } else {
    statsBar.innerHTML = t.stats.replace('{visible}', visibleCount).replace('{total}', total);
  }
}

function handleSearch() {
  applyFilters();
}

function clearSearch() {
  const input = document.getElementById('searchInput');
  input.value = '';
  input.focus();
  applyFilters();
}

function openDocModal() {
  document.getElementById('docModalBody').innerHTML = regulationContent;
  document.getElementById('docModal').classList.add('show');
  document.body.style.overflow = 'hidden';
}

function closeDocModal(event) {
  if (!event || event.target.id === 'docModal' || event.target.closest('.modal-close')) {
    document.getElementById('docModal').classList.remove('show');
    document.body.style.overflow = '';
  }
}

function openDetailModal(id) {
  const comp = competitions.find(c => c.id === id);
  const t = translations[currentLang];
  const displayName = currentLang === 'en' ? comp.nameEn : comp.name;
  
  document.getElementById('detailName').textContent = displayName;
  let levelText = '';
  if (comp.level === 'A') levelText = t.levelA;
  else if (comp.level === 'B') levelText = t.levelB;
  else if (comp.level === 'B*') levelText = t.levelB2;
  else levelText = t.levelC;
  
  const levelColors = {
    'A': '#ff6b6b',
    'B': '#4facfe',
    'B*': '#11998e',
    'C': '#f093fb'
  };
  
  document.getElementById('detailLevel').innerHTML = 
    `<span style="color: ${levelColors[comp.level]}; font-weight: 700;">${comp.level}${currentLang === 'zh-CN' || currentLang === 'zh-TW' ? 'ç±»' : ' Class'}</span> ${levelText}`;
  
  const searchName = comp.name;
  document.getElementById('bingLink').href = `https://www.bing.com/search?q=${encodeURIComponent(searchName)}`;
  document.getElementById('bilibiliLink').href = `https://search.bilibili.com/all?keyword=${encodeURIComponent(searchName)}`;
  document.getElementById('zhihuLink').href = `https://www.zhihu.com/search?type=content&q=${encodeURIComponent(searchName)}`;
  document.getElementById('xhsLink').href = `https://www.xiaohongshu.com/search_result?keyword=${encodeURIComponent(searchName)}`;
  
  document.getElementById('detailModal').classList.add('show');
}

function closeDetailModal(event) {
  if (!event || event.target.id === 'detailModal' || event.target.closest('.modal-close')) {
    document.getElementById('detailModal').classList.remove('show');
  }
}

document.addEventListener('click', function(e) {
  if (!e.target.matches('.control-btn')) {
    document.querySelectorAll('.dropdown-menu').forEach(d => d.classList.remove('show'));
  }
});

// åˆå§‹åŒ–
window.onload = init;
</script>
</body>
</html>
